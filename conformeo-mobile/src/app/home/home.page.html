<ion-header [translucent]="true">
  <ion-toolbar color="primary">
    <ion-title>
      Conforméo
    </ion-title>

    <ion-buttons slot="start">
      <ion-button routerLink="/dashboard">
        <ion-icon name="stats-chart-outline"></ion-icon>
      </ion-button>
      
      <ion-button routerLink="/materiel">
        <ion-icon name="hammer-outline"></ion-icon>
      </ion-button>
    </ion-buttons>

    <ion-buttons slot="end">
      <ion-icon 
        [name]="isOnline ? 'cloud-done' : 'cloud-offline'" 
        [color]="isOnline ? 'success' : 'danger'"
        style="font-size: 24px; margin-right: 10px;">
      </ion-icon>
      
      </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding-top">
  
  <ion-refresher slot="fixed" (ionRefresh)="loadChantiers($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <h2 style="margin-left: 16px; margin-top: 10px; font-weight: 700;">
    Mes Chantiers
  </h2>
  
  <div *ngIf="chantiers.length === 0" style="text-align: center; margin-top: 50px; opacity: 0.6;">
    <p>Aucun chantier trouvé.</p>
  </div>

  <div class="feed-container">
    
    <div *ngFor="let c of chantiers" class="chantier-card" [routerLink]="['/chantier', c.id]">
      
      <div class="card-image" [style.background-image]="'url(' + (c.cover_url || 'assets/splash.png') + ')'">
        
        <div class="status-badge" [class.active]="c.est_actif">
          {{ c.est_actif ? 'En cours' : 'Terminé' }}
        </div>

        <div class="card-overlay">
          <h3 class="chantier-title">{{ c.nom }}</h3>
          <p class="chantier-location">
            <ion-icon name="location-outline"></ion-icon> {{ c.adresse }}
          </p>
          <p class="chantier-client">Client: {{ c.client }}</p>
        </div>
      </div>

      <div class="card-actions">
        <div class="action-btn">
          <ion-icon name="camera-outline"></ion-icon>
          <span>Photo</span>
        </div>
        <div class="action-btn">
          <ion-icon name="document-text-outline"></ion-icon>
          <span>Rapport</span>
        </div>
        <div class="action-btn">
          <ion-icon name="call-outline"></ion-icon>
          <span>Appeler</span>
        </div>
      </div>

    </div>
  </div>

  <ion-fab vertical="bottom" horizontal="end" slot="fixed">
    <ion-fab-button (click)="openAddModal()"> <ion-icon name="add"></ion-icon>
    </ion-fab-button>
  </ion-fab>

</ion-content>